# Task ID: 5
# Title: Implement SundialKitCombine compatibility plugin
# Status: pending
# Dependencies: 2, 3
# Priority: high
# Description: Create Combine-based plugin package providing v1.0.0 API compatibility with NetworkObserver and ConnectivityObserver
# Details:
Create SundialKitCombine plugin for backwards compatibility:
1. NetworkObserver implementation:
   - Wrap NetworkMonitor from SundialKitCore (once extracted from Sources/SundialKit/Network/NetworkObserver.swift)
   - @Published properties: pathStatus, isExpensive, isConstrained
   - Publishers: pathStatusPublisher, isExpensivePublisher, etc.
   - PassthroughSubject utilities from Sources/SundialKit/PassthroughSubject.swift
   - Implement NetworkStateObserver to bridge changes
2. ConnectivityObserver implementation:
   - Wrap ConnectivityManager from SundialKitCore (once extracted from Sources/SundialKit/WatchConnectivity/ConnectivityObserver.swift)
   - All v1.0.0 publishers maintained
   - sendingMessageSubject for message sending (line 43 in current implementation)
   - messageReceivedPublisher, replyMessagePublisher
3. Exact v1.0.0 API surface - no breaking changes
4. @available guards for platform compatibility
5. Swift 5.9+ support
6. Platform: iOS 13+, watchOS 6+, tvOS 13+, macOS 10.15+

Critical: Must pass all v1.0.0 tests unchanged. Current codebase analysis shows existing NetworkObserver at Sources/SundialKit/Network/NetworkObserver.swift uses PassthroughSubjects and Combine publishers (lines 71-107). ConnectivityObserver at Sources/SundialKit/WatchConnectivity/ConnectivityObserver.swift has sendingMessageSubject and other publishers (lines 43-85). GitHub Issue: #33, Component: Combine Plugin

# Test Strategy:
Swift Testing migration required. Run entire v1.0.0 test suite against plugin, verify zero API changes needed, test publisher behavior matches v1 exactly. Reference existing test patterns from Tests/SundialKitTests/Network/NetworkObserverTests.swift and Tests/SundialKitTests/WatchConnectivity/ConnectivityObserverPropertyTests.swift.

# Subtasks:
## 1. Create SundialKitCombine package structure and NetworkObserver wrapper [pending]
### Dependencies: None
### Description: Set up the SundialKitCombine Swift package with proper directory structure and create the NetworkObserver class that wraps NetworkMonitor from SundialKitCore
### Details:
Create Package.swift with SundialKitCombine target, add dependency on SundialKitCore. Create NetworkObserver class with @Published properties for pathStatus, isExpensive, and isConstrained. Initialize with NetworkMonitor instance and set up property observation bridges. Reference current NetworkObserver implementation at Sources/SundialKit/Network/NetworkObserver.swift for API compatibility.

## 2. Implement NetworkObserver publishers and PassthroughSubject utilities [pending]
### Dependencies: 5.1
### Description: Add all v1.0.0 publishers to NetworkObserver including pathStatusPublisher, isExpensivePublisher, isConstrainedPublisher, and port PassthroughSubject extension utilities
### Details:
Create Combine publishers for each observable property using @Published projectedValue. Port the PassthroughSubject extension with anyPublisher(for:) helper from Sources/SundialKit/PassthroughSubject.swift (lines 36-40). Implement NetworkStateObserver conformance to bridge state changes from NetworkMonitor to Combine publishers. Maintain exact API from current NetworkObserver (lines 90-107).

## 3. Create ConnectivityObserver wrapper around ConnectivityManager [pending]
### Dependencies: 5.1
### Description: Implement ConnectivityObserver class wrapping ConnectivityManager from SundialKitCore with all v1.0.0 @Published properties
### Details:
Create ConnectivityObserver with @Published properties: activationState, isReachable, isPaired, isPairedAppInstalled. Initialize with ConnectivityManager instance. Set up property bridges to observe ConnectivityManager state changes and update @Published properties accordingly. Reference current ConnectivityObserver API at Sources/SundialKit/WatchConnectivity/ConnectivityObserver.swift.

## 4. Implement message publishers and sending subject [pending]
### Dependencies: 5.3
### Description: Add sendingMessageSubject, messageReceivedPublisher, and replyMessagePublisher to ConnectivityObserver maintaining exact v1.0.0 behavior
### Details:
Create sendingMessageSubject as PassthroughSubject<ConnectivityMessage, Never> (matching line 43 in current implementation). Implement messageReceivedPublisher and replyMessagePublisher using PassthroughSubject (lines 77-85). Bridge ConnectivityManager's message callbacks to emit on appropriate publishers. Ensure sendingMessageSubject triggers actual message sending through ConnectivityManager, following current sendMessage implementation (lines 163-182).

## 5. Bridge observer callbacks to Combine publishers [pending]
### Dependencies: 5.2, 5.4
### Description: Implement ConnectivityStateObserver and ConnectivityMessageObserver conformance to bridge all callbacks from core to Combine layer
### Details:
Implement observer protocol methods to receive state changes and messages from NetworkMonitor and ConnectivityManager. Convert all callback data to appropriate Combine publisher emissions. Ensure thread safety and proper memory management with weak self captures in closures. Handle platform-specific callbacks appropriately. Reference current delegate pattern implementation (lines 126-199 in ConnectivityObserver.swift).

## 6. Verify complete v1.0.0 API compatibility with existing tests [pending]
### Dependencies: 5.5
### Description: Run entire v1.0.0 test suite against SundialKitCombine plugin to ensure zero breaking changes and complete API surface coverage
### Details:
Import all v1.0.0 tests into SundialKitCombine test target. Update import statements from SundialKit to SundialKitCombine. Run full test suite without any modifications to test code. Document any missing APIs or behavioral differences. Add @available guards for platform compatibility as needed. Reference existing test files: Tests/SundialKitTests/Network/NetworkObserverTests.swift, Tests/SundialKitTests/WatchConnectivity/ConnectivityObserverPropertyTests.swift, Tests/SundialKitTests/WatchConnectivity/ConnectivityObserverMessageTests.swift, Tests/SundialKitTests/PassthroughSubjectTests.swift.

